#!/bin/bash

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞—É–¥–∏–æ–∫–Ω–∏–≥–∏

echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞—É–¥–∏–æ–∫–Ω–∏–≥–∏"
echo "=================================================="
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ venv
if [ -d "venv" ]; then
    echo "‚úÖ –ù–∞–π–¥–µ–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ venv"
    source venv/bin/activate
elif [ -d ".venv" ]; then
    echo "‚úÖ –ù–∞–π–¥–µ–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ .venv"
    source .venv/bin/activate
else
    echo "‚ö†Ô∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
    echo "   –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ..."
    python3 -m venv venv
    source venv/bin/activate
fi

echo ""
echo "üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –ø–∞–∫–µ—Ç–æ–≤..."

# –û–±–Ω–æ–≤–ª—è–µ–º pip
pip install --upgrade pip

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
pip install edge-tts
pip install pydub

echo ""
echo "‚úÖ Python –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º ffmpeg
echo ""
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ ffmpeg..."
if command -v ffmpeg &> /dev/null; then
    echo "‚úÖ ffmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå ffmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo ""
    echo "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ffmpeg:"
    echo "  macOS:  brew install ffmpeg"
    echo "  Linux:  apt install ffmpeg"
    echo "  Windows: —Å–∫–∞—á–∞–π—Ç–µ —Å https://ffmpeg.org"
fi

echo ""
echo "üéâ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo ""
echo "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å:"
echo "  ./create_audiobook.sh"
echo ""
echo "–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:"
echo "  source venv/bin/activate"
echo "  python3 05_create_audiobook.py --help"